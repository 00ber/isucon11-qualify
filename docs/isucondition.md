# ISUCONDITION アプリケーションマニュアル

<<<<<<< HEAD
![ISUCONDITIONロゴ](https://s3-ap-northeast-1.amazonaws.com/hackmd-jp1/uploads/upload_f7b1f89768906f3a6d8280f4814af567.png)
=======
![](https://s3-ap-northeast-1.amazonaws.com/hackmd-jp1/uploads/upload_f7b1f89768906f3a6d8280f4814af567.png)
>>>>>>> c3712f2 (feat(docs): ISUCONDITIONのアプリケーション仕様を記述)


## ISUCONDITION とは

**"ISUとつくる新しい明日"**

あなたの大事なパートナーであるISUが教えてくれるコンディションから、ISUの状態やその変化をスコアとして知ることで、大事なISUと長く付き合っていくためのサービスです。

## サービス紹介

<<<<<<< HEAD
[ISUCONDITION コマーシャル](TODO:リンク)
=======
[ISUCONDITION コマーシャル](リンク)
>>>>>>> c3712f2 (feat(docs): ISUCONDITIONのアプリケーション仕様を記述)

## 用語

- **ISU**: この世界で愛されるあなたの大事なパートナー。いろいろな性格を持っていて、その時その時のコンディションを通知してくれる。
- **ユーザ**: ISUCONDITIONに登録をしている人。
- **閲覧者**: ISUCONDITIONに登録はしていないが、Topページでトレンドを見ている人。
- **JIA**: Japan ISU Associationの略。たぶん日本のイスを取りまとめる団体。しらんけど。
- **コンディション**: ISUから送られてくる情報。ISUが誰かに座られているか、どんな状態かなどを教えてくれる。
- **ISUの状態**: 
<<<<<<< HEAD
    - **Info**: 良い状態。何も問題が起きていない状態。
=======
    - **Info**: 何も問題が起きていない状態。
>>>>>>> c3712f2 (feat(docs): ISUCONDITIONのアプリケーション仕様を記述)
    - **Warning**: 1〜2個問題が起きている状態。
    - **Critical**: 何もかもが問題な状態。
- **スコア**: コンディションから計算された1時間毎の点数（0~100）
- **グラフ**: 1日の中でスコアが遷移した記録
- **トレンド**: ISUCONDITIONに登録されているISUたちの、性格ごとの最新の状態を表示したもの。

## ISUCONDITONの機能とユーザ、ISU、閲覧者について

### 1. ユーザ登録/ログイン

<<<<<<< HEAD
**ユーザ**は、JIAのアカウントを利用してユーザ登録/ログイン (`/login`) を行います。JIAへログインし、そこで得たトークン（JWT:JSON Web Token）を元にISUCONDITIONへアクセスを行います。

### 2. ISUの登録とISUのコンディション送信処理

**ユーザ**は、自分の大事なパートナーであるISUを、JIAが発行するISU固有のID(以下、ISU UUID)を使い、ISUCONDITIONに登録 (`/register`) します。**ユーザ**は、登録を行ったISUの詳細 (`/isu/:jia_isu_uuid`) や、ISUの状態 (`/isu/:jia_isu_uuid/condition`) 、グラフとスコア (`/isu/:jia_isu_uuid/graph`) を見ることができます。

**JIA**は、ISUCONDITIONからISU UUIDを受け取ることで、当該のISU UUIDを持つISUに対してISUCONDITIONへコンディション送信 (`POST /api/condition/:jia_isu_uuid`) を開始する指示をします。

**ISU**は、JIAから送信開始の指示を受け取った時点から、自身のコンディションをISUCONDITIONに対して送信 (`POST /api/condition/:jia_isu_uuid`) を続けます。**ISU**のコンディションは悪くなる事があり、ユーザが改善を行わない限りコンディションが良くなる事はありません。

ISUの置かれた環境など様々な影響からコンディションが欠損することがありますが、ISUがコンディションに含める送信時刻は過去に戻ることはありません。

ISUCONDITIONは、ISUから送信されるコンディション (`POST /api/condition/:jia_isu_uuid`) データを保持しますが、アプリケーションが高負荷な場合データを保存せず `503 Service Unavailable` を返すことを許容しています。

### 3. 登録済みのISUの確認

**ユーザ**は、一定の頻度でログイン後のトップページ (`/`) に表示される、自身が登録したISUの一覧を確認しています。ユーザはISUの一覧を受け取ったとき、各ISUの詳細 (`/isu/:jia_isu_uuid`) を確認します。
=======
**ユーザ**は、JIAのアカウントを利用してユーザ登録/ログイン (`POST /api/auth`) を行います。JIAへログインし、そこで得たトークン（JWT:JSON Web Token）を元にISUCONDITIONへアクセスを行います。

### 2. ISUの登録とISUのコンディション送信処理

**ユーザ**は、自分の大事なパートナーであるISUを、JIAが発行するISU固有のID(以下、ISU UUID)を使い、ISUCONDITIONに登録 (`POST /api/isu`) します。**ユーザ**は、登録を行ったISUの、ISUの状態 (`GET /api/isu/:jia_isu_uuid`) やグラフとスコア (`GET /api/isu/:jia_isu_uuid/graph`) を見ることができます。

**JIA**は、ISUCONDITIONからISU UUIDを受け取ることで、当該のISU UUIDを持つISUに対してISUCONDITIONへコンディション送信 (`POST /api/condition/:jia_isu_uuid`) を開始する指示をします。

**ISU**は、JIAから送信開始の指示を受け取った時点から、一定間隔で自身のコンディションをISUCONDITIONに対して送信 (`POST /api/condition/:jia_isu_uuid`) を続けます。コンディションは一定の確率で悪くなる事があり、ユーザが改善を行わない限りコンディションが良くなる事はありません。

ISUの置かれた環境など様々な影響からコンディションが欠損することがありますが、ISUがコンディションに含める送信時刻は過去に戻ることはありません。

ISUCONDITIONは、ISUから送信されるコンディション (`POST /api/condition/:jia_isu_uuid`) データを保持しますが、アプリケーションが高負荷な場合 `503 Service Unavailable` を返すことを許容しています。

### 3. 登録済みのISUの確認

**ユーザ**は、一定の頻度で自身が登録したISUの一覧 (`GET /api/isu`) を確認しています。ユーザはISUの一覧を受け取ったとき、各ISUの詳細 (`GET /api/isu/:jia_isu_uuid`) を確認します。
>>>>>>> c3712f2 (feat(docs): ISUCONDITIONのアプリケーション仕様を記述)
他のユーザのISUについて見ることできません。

### 4. ISUの状態確認

<<<<<<< HEAD
**ユーザ**は、ISUの詳細を確認後に「グラフの確認」、「状態の確認」、「状態の悪いISUの修理」を行います。
これらの3つ処理が正しく1回行われると、閲覧者が1人増えます。（MEMO: 現在の仕様であり変更が入るかも）

#### 4.1. グラフの確認

ユーザは、当日のグラフを確認 (`/isu/:jia_isu_uuid/graph`) 後、まだ確認していない日付のグラフがある場合、過去日付に遡ってグラフを確認します。
未読のグラフ確認後、最後に見ていたグラフのデータが存在する時間をランダムに1時間選択し、その状態を確認します。

#### 4.2. 状態の確認

ユーザは、ISUのコンディションを確認 (`/isu/:jia_isu_uuid/condition`) 後、まだ確認していない状態がある場合、過去に遡って状態を確認します。

#### 4.3. 状態の悪いISUの改善

**ユーザ**は、ISUの状態が悪く(`warning`, `critical`)なっていないかを確認し、状態の悪いISUがあった場合にISUの状態を改善します。
=======
**ユーザ**は、ISUの詳細を確認後に「グラフの確認」、「状態の確認」、「状態の悪いISUの修理」を行います。ユーザはこれらのうちどの行動を行うかは、一定の確率で選択をします。

#### 4.1. グラフの確認

ユーザは、当日のグラフを確認 (`GET /api/isu/:jia_isu_uuid/graph`) 後、まだ確認していない日付のグラフがある場合、過去日付に遡ってグラフを確認します。

#### 4.2. 状態の確認

ユーザは、ISUのコンディションを確認 (`GET /api/condition/:jia_isu_uuid`) 後、まだ確認していない状態がある場合、過去に遡ってグラフを確認します。

#### 4.3. 状態の悪いISUの修理

ユーザは、状態の悪いISUのコンディションを確認 (`GET /api/condition/:jia_isu_uuid?condition_level=critical,warnin`) 後、状態の悪いISUがあった場合にISUの状態改善を行います。状態の改善は瞬時に完了します。
>>>>>>> c3712f2 (feat(docs): ISUCONDITIONのアプリケーション仕様を記述)

ユーザにより状態改善が行われたISUは、次のコンディション送信からは改善されたコンディションを送信します。

### 5. トレンド

<<<<<<< HEAD
閲覧者は、**"未ログイン状態"** でISUCONDITIONのトップページ　(`/`) に表示されるトレンドを確認しています。
トレンドにはISUCONDITIONに登録されているすべてのISUたちの最新状態が取得でき、これらの状態はISUが持つ性格ごとにまとまった形となっています。

サービスに興味を持った閲覧者はサービストップページに表示されるトレンドを一定間隔で閲覧し、トレンドの変化に注目しています。
閲覧者がトレンドの変化を1回確認するたびに、ユーザが1人増加します。（MEMO: 現在の仕様であり変更が入るかも）
=======
閲覧者は、ISUCONDITIONのページトップに表示されるトレンド　(`GET /api/trend`) を確認することで、ISUCONDITIONに登録されているISUたちの、性格ごとの最新の状態を閲覧することができます。

サービスに興味を持った閲覧者はサービストップページに表示されるトレンドを一定間隔で閲覧し、トレンドの変化に注目しています。閲覧者はトレンドの変化を確認すると、サービスに興味を持ち、ユーザ登録を行った後に、自信が所有するISUを登録します。

TODO: 閲覧者がどうやって増えるかを確認
>>>>>>> c3712f2 (feat(docs): ISUCONDITIONのアプリケーション仕様を記述)

トレンドはISUCONDITIONのサービスを知ってもらうために、ユーザ以外にも公開されているためログインは不要です。
